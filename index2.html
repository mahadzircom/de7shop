<!DOCTYPE html>
<html lang="ms">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Tempah Baju Melayu Elrah Exclusive 2026 | Koleksi Raya DE7SHOP</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">

<style>
body{font-family:'Poppins',sans-serif;background:#e9f5e6;padding:20px;margin:0;}
header.main-header{text-align:center;padding:25px;background:linear-gradient(135deg,#0b5328,#0f6b32);color:#f7d87c;border-radius:14px;margin-bottom:25px;}
section.card{background:#fff;padding:15px;margin-bottom:25px;border-radius:12px;border:2px solid #c9e8c1;}
.btn-add{background:#0f6b32;color:#fff;padding:12px;border:none;border-radius:8px;width:100%;font-weight:bold;}
select,input{width:100%;padding:12px;margin-top:8px;border-radius:10px;border:2px solid #d8f2d2;}
.cart-box{position:fixed;bottom:0;left:0;right:0;background:#fff;padding:15px;border-top:3px solid #0f6b32;max-height:33vh;overflow-y:auto;}
.cart-item{display:flex;justify-content:space-between;border-bottom:1px solid #ddd;padding:8px 0;font-size:14px;}
.cart-actions button{padding:4px 8px;border:none;border-radius:6px;color:#fff;background:#137f3b;}
.cart-actions .delete{background:#e53935;}
.cart-total{text-align:right;font-size:18px;font-weight:bold;color:#0f6b32;}
.checkout{background:#f4b400;padding:12px;width:100%;border:none;border-radius:10px;font-size:16px;font-weight:bold;}
.popup{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%) scale(.8);background:#fff;padding:25px;border-radius:20px;box-shadow:0 10px 30px rgba(0,0,0,.3);opacity:0;pointer-events:none;transition:.3s;}
.popup.show{opacity:1;pointer-events:auto;transform:translate(-50%,-50%) scale(1);}
#voucher.valid{border-color:green;background:#e0f7e9;}
#voucher.invalid{border-color:red;background:#ffe6e6;}
.spacer{height:300px;}
</style>
</head>

<body>

<header class="main-header">
<h1>ORDER ELRAH EXCLUSIVE<br>DE7SHOP</h1>
<p>Beli Dengan Harga Jimat</p>
</header>

<main>
<div id="productList"></div>

<section class="card">
<h3>Maklumat Pelanggan</h3>
<input id="nama" placeholder="Nama">
<input id="telefon" placeholder="No Telefon">
<input id="alamat" placeholder="Alamat / Nota">
<h3>Kod Voucher</h3>
<input id="voucher" placeholder="Contoh: DE7SHOP7%">
</section>
</main>

<div class="spacer"></div>

<div class="cart-box">
<div id="cartList"></div>
<div class="cart-total">Total: RM<span id="total">0</span></div>
<button class="checkout" onclick="hantarWhatsApp()">Hantar WhatsApp</button>
</div>

<div class="popup" id="popup">
<h3 id="popupTitle"></h3>
<p id="popupMsg"></p>
</div>

<script src="data.js"></script>

<script>
let cart = [];

const VOUCHER = {
 "DE7SHOP7%": {type:"percent", value:7},
 "DE7SHOP15": {type:"flat", value:15},
 "NEWUSER5": {type:"percent", value:5}
};

function showPopup(t,m){
 popupTitle.innerText=t;
 popupMsg.innerText=m;
 popup.classList.add("show");
 setTimeout(()=>popup.classList.remove("show"),2500);
}

function renderProduk(){
 const wrap=document.getElementById("productList");
 Object.entries(PRODUK).forEach(([k,p])=>{
  wrap.innerHTML+=`
  <section class="card">
   <h3>${p.nama}</h3>
   <b>RM${p.harga}</b>
   <select id="w-${k}">${p.warna.map(w=>`<option>${w}</option>`).join("")}</select>
   <select id="s-${k}">${p.saiz.map(s=>`<option>${s}</option>`).join("")}</select>
   <select id="q-${k}"><option>1</option><option>2</option><option>3</option></select>
   <button class="btn-add" onclick="addProduk('${k}')">Tambah Cart</button>
  </section>`;
 });
}

function addProduk(k){
 const p=PRODUK[k];
 const color=document.getElementById(`w-${k}`).value;
 const size=document.getElementById(`s-${k}`).value;
 const qty=parseInt(document.getElementById(`q-${k}`).value);
 const ex=cart.find(i=>i.k==k && i.color==color && i.size==size);
 if(ex) ex.qty+=qty;
 else cart.push({k,name:p.nama,price:p.harga,color,size,qty});
 updateCart();
 showPopup("Berjaya","Produk dimasukkan ke cart");
}

function updateCart(){
 cartList.innerHTML="";
 let subtotal=0;
 cart.forEach((i,idx)=>{
  const sum=i.price*i.qty; subtotal+=sum;
  cartList.innerHTML+=`
  <div class="cart-item">
   <div>${i.name}<br><small>${i.color}, ${i.size}</small><br><b>RM${sum}</b></div>
   <div class="cart-actions">
    <button onclick="i.qty--;updateCart()">-</button>
    ${i.qty}
    <button onclick="i.qty++;updateCart()">+</button>
    <button class="delete" onclick="cart.splice(${idx},1);updateCart()">X</button>
   </div>
  </div>`;
 });
 document.getElementById("total").innerText=subtotal;
}

function hantarWhatsApp(){

 if(cart.length==0)
   return showPopup("Cart kosong","Sila pilih produk");

 const namaEl=document.getElementById("nama");
 const telEl=document.getElementById("telefon");
 const alamatEl=document.getElementById("alamat");
 const voucherEl=document.getElementById("voucher");

 const nama=namaEl.value.trim();
 const tel=telEl.value.trim();
 const alamat=alamatEl.value.trim();
 const v=voucherEl.value.trim().toUpperCase();

 if(!nama||!tel)
   return showPopup("Maklumat","Isi nama & telefon");

 let subtotal=0,totalQty=0;
 let msg=`*ORDER ELRAH EXCLUSIVE â€“ DE7SHOP*\n=========================\n\nNama: ${nama}\nTel: ${tel}\nAlamat: ${alamat}\n\n`;

 cart.forEach((i,n)=>{
  const s=i.price*i.qty;
  subtotal+=s;
  totalQty+=i.qty;
  msg+=`${n+1}. ${i.name}\n${i.color}, ${i.size} x${i.qty} (RM${s})\n`;
 });

 // ðŸšš KOS POS (contoh)
 let kosPos = totalQty>0 ? 10 + ((totalQty-1)*3) : 0;

 let diskaun=0;
 let voucherMsg="Voucher tidak digunakan";

 if(VOUCHER[v]){
  voucherEl.className="valid";
  if(VOUCHER[v].type=="percent"){
    cart.forEach(i=>{
      diskaun+=Math.round((i.price*VOUCHER[v].value/100)*i.qty);
    });
  }else{
    diskaun=VOUCHER[v].value*totalQty;
  }
  voucherMsg="Voucher sah";
  showPopup("Voucher Sah",`Anda jimat RM${diskaun}`);
 }
 else if(v){
  voucherEl.className="invalid";
  voucherMsg="Voucher tidak sah";
 }

 const jumlahAkhir = subtotal - diskaun + kosPos;

 msg+=`\nSubtotal RM${subtotal}\nDiskaun RM${diskaun}\nKos Pos RM${kosPos}\n-------------------\nJumlah RM${jumlahAkhir}\n(${voucherMsg})`;

 setTimeout(()=>{
   window.open("https://wa.me/60133876000?text="+encodeURIComponent(msg),"_blank");
 },300);

 cart=[];updateCart();
 namaEl.value=telEl.value=alamatEl.value=voucherEl.value="";
 voucherEl.className="";
}

document.addEventListener("DOMContentLoaded",renderProduk);
</script>

</body>
</html>
